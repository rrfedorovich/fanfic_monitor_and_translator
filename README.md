# Fanfic monitor and translator

**Fanfic monitor and translator** - программа на Python для отслеживания новых глав на SpaceBattles и SufficientVelocity (пока только на них), создания файла из переведенных и отправки его в Ваш телеграм в Избранное.

---

## Оглавление

- [1. Подготовка](#1-подготовка)
- [2. Версия с графическим интерфейсом](#2-версия-с-графическим-интерфейсом)
  - [2.1. Установка](#21-установка)
    - [2.1.1. Скачивание и установка библиотек](#211-скачивание-и-установка-библиотек)
    - [2.1.2. Запуск](#212-запуск)
    - [2.1.3. Настройка](#213-настройка)
      - [2.1.3.1 Описание параметров](#2131-описание-параметров)
    - [2.1.4. Указание фанфиков](#214-указание-фанфиков)
    - [2.1.5 Первичный запуск](#215-первичный-запуск)
  - [2.2. Использование](#22-использование)
- [3. Консольная версия](#3-консольная-версия)
  - [3.1. Установка](#31-установка)
    - [3.1.1. Скачивание и установка библиотек](#311-скачивание-и-установка-библиотек)
    - [3.1.2. Настройка](#312-настройка)
    - [3.1.3. Указание фанфиков](#313-указание-фанфиков)
    - [3.1.4. Первичный запуск](#314-первичный-запуск)
  - [3.2. Использование](#32-использование)
    - [3.2.1. Рекомендации](#321-рекомендации)
- [4. Замечания](#4-замечания)
- [5. Установка в Replit](#5-установка-в-replit)
  - [5.1. Установка](#51-установка)
    - [5.1.1. Создание приложения](#511-создание-приложения)
    - [5.1.2. Запуск скрипта](#512-запуск-скрипта)
    - [5.1.3. Настройка Secrets](#513-настройка-secrets)
    - [5.1.4. Указание фанфиков](#514-указание-фанфиков)
    - [5.1.5. Первичный запуск](#515-первичный-запуск)
  - [5.2. Использование](#52-использование)
- [6. Лицензия](#6-лицензия)

---

## 1. Подготовка

Если не нужна отправка файлов с переведенными главами в Telegram, то данный пункт можно пропустить.

Для взаимодействия с Telegram понадобятся `api_id` и `api_hash`. Для этого нужно авторизоваться [здесь](https://my.telegram.org/), перейти в раздел "API development tools", заполнить поля и получить эти два значения.
Более подробно [здесь](https://core.telegram.org/api/obtaining_api_id#obtaining-api-id).

---

## 2. Версия с графическим интерфейсом

### 2.1. Установка

#### 2.1.1. Скачивание и установка библиотек

Скачайте код любым способом, затем с помощью терминала перейдите в корень проекта.
Затем установите необходимые библиотеки: `pip install -r requirements_gui.txt`.

Рекомендуется использовать виртуальные окружения.

#### 2.1.2. Запуск

Запустить можно через терминал, перейдя в корень проекта и выполнив код: `py .\src\gui.py`.

Для Windows можно запустить `run_gui_on_windows.bat`. Не рекомендуется, пока не будет выполнен [первичный запуск](#215-первичный-запуск). Если используете виртуальное окружение, то в bat-скрипте необходимо указать директорию с ним, смотрите строки 4-9 скрипта.

#### 2.1.3. Настройка

![Вкладка "Настройки"](images/settings.png)

Во вкладке "Настройки" задайте значения в соответствующем столбце, затем нажмите кнопку "Сохранить".
Чтобы начать редактирование, необходимо дважды щелкнуть по ячейке.

##### 2.1.3.1. *Описание параметров*

- Настройки Telegram:
  - `TELEGRAM_ON` - включена ли отправка переведенных глав в Telegram. 1 - да, 0 - нет. Если выключено, остальные настройки Telegram можно не заполнять;
  - `API_ID` и `API_HASH` - значения из пункта [подготовки](#1-подготовка);
  - `PHONE` - Ваш номер телефона в стиле +7.....;
- `FANFICS_CSV_PATH` - путь к каталогу фанфиков (csv-файлу). Указывать либо абсолютный путь, либо относительный от корня проекта. Проще не менять;
- `FANFICS_OUT_DIR` - путь к папке, куда будут сохраняться файлы с переведенными главами. Указывать либо абсолютный путь, либо относительный от корня проекта. Если не изменять, то будут сохраняться в папке `fanfics` в корне проекта.

#### 2.1.4. Указание фанфиков

![Вкладка "Фанфики"](images/fanfics.png)

Во вкладке "Фанфики" есть таблица с тремя столбцами:

- Название - будет использоваться для логов и именования файла для фанфика.
- Адрес фанфика - URL-адрес фанфика.
- Номер последней главы - указывает номер последней переведенной главы. Для новых фанфиков ставить 0.

Чтобы добавить фанфик, необходимо нажать кнопку "Добавить запись", а позже заполнить строчку.
Чтобы удалить фанфик, необходимо нажать на строчку с ним (любую ячейку) и нажать кнопку "Удалить запись".
После внесения изменений обязательно нажать "Сохранить".

#### 2.1.5. Первичный запуск

Когда приложению понадобится в первый раз отправить файл в Telegram (если отправка включена), в терминале, из коротого была запущена программа, будет запрос на код от Telegram (придет в сам мессенджер), а затем на пароль Telegram (если установили). Их нужно ввести в терминал.

### 2.2. Использование

Использование приложение состоит из [запуска](#212-запуск), [обновления отслеживаемых фанфиков](#214-указание-фанфиков) и нажатия кнопки "Запустить перевод".

---

## 3. Консольная версия

### 3.1. Установка

#### 3.1.1. Скачивание и установка библиотек

Скачайте код любым способом, затем с помощью терминала перейдите в корень проекта.
Установите необходимые библиотеки: `pip install -r requirements_console.txt`.

Рекомендуется использовать виртуальные окружения.

#### 3.1.2. Настройка

В папке `setting` переименовать файл `.env_example` в `.env`. Далее необходимо отредактировать значения внутри одинарных кавычек. Описание параметров [здесь](#2131-описание-параметров).

#### 3.1.3. Указание фанфиков

В папке `setting` есть файл `fanfics_example.csv`. Это образец того, как нужно указывать фанфики вручную. Файл нужно переименовать и перенести согласно настройкам из предыдущего пункта. Если ничего не изменяли, то достаточно просто переименовать в `fanfics.csv`.

Первая строчка - это названия столбцов. Каждая последующая - отдельный фанфик. Необходимо через `;` без каких-либо пробелов в каждой строчке указать:

- название фанфика (можно любое, используется для логов и именования файлов);
- URL-адрес фанфика;
- номер последней переведенной главы (для новых фанфиков ставить 0).

#### 3.1.4. Первичный запуск

Запустить можно через терминал, перейдя в корень проекта и выполнив код: `py .\src\console.py`.
Когда приложению понадобится в первый раз отправить файл в Telegram (если отправка включена), в терминале, из коротого была запущена программа, будет запрос на код от Telegram (придет в сам мессенджер), а затем на пароль Telegram (если установили). Их нужно ввести в терминал.

### 3.2. Использование

Использование приложения состоит из [обновления отслеживаемых фанфиков](#313-указание-фанфиков) (когда нужно) и запуска приложения через терминал. Для этого надо в терминале перейти в корень проекта и выполнить код: `py .\src\console.py`.

#### 3.2.1. Рекомендации

Удобнее всего добавить консольную версию в планировщик. Но не забывайте про запуск консольной версии от корня проекта (иначе собьются относительные пути с настройками) и, если используете, про виртуальные окружения.
То есть все, что нужно, это написать еще один скрипт и поместить его в планировщик, в скрипте:

- перейти в корень проекта;
- активировать виртуальное окружение (если используете);
- запустить консольную версию `py .\src\console.py`

---

## 4. Замечания

***Настройки едины для графической и консольной версий, поэтому, произведя их один раз, можно использовать обе версии.***

Приложение предназначено для мониторинга и перевода новых глав, а не скачивания всего фанфика сразу. Это работает, но медленно. Перевод 100K слов с моим интернетом занимает примерно 3 минуты.
Впрочем, я переводил так фанфики и с 1M слов: запустил и забыл.

Нет скачивания картинок.

Нет оформления текста: курсив, жирность и прочее.

---

## 5. Установка в Replit

Бесплатно и удобно. После настройки можно зайти в Replit и запустить приложение хоть с телефона, а потом файлы с переведенными главами придут в Telegram.

### 5.1. Установка

#### 5.1.1. Создание приложения

После регистрации нужно создать пустое Python-приложение.

На сайте это можно сделать выбрав `Developer Frameworks` в столбце слева, затем выбрать `Python`. Потом нажать `Remix`. Заполнить поля и нажать `Use Framework`.

В мобильном приложении нажать `Create`, нажать троеточие сверху справа, выбрать `Remix a Template`, выбрать `Python`, заполнить поля и нажать `Create`.

#### 5.1.2. Запуск скрипта

Открыть инструмент `Shell` и выполнить в нем код ниже:

```Bash
curl -s https://raw.githubusercontent.com/rrfedorovich/fanfic_monitor_and_translator/master/setup_replit.py | python -
```

#### 5.1.3. Настройка Secrets

Открыть инструмент `Secrets`. Здесь нужно указать параметры, которые перечислены [здесь](#2131-описание-параметров). Это делается с помощью нажатия кнопки `New Secret`, заполнения двух полей (названия и значения), затем нажатия кнопки `Add Secret` для каждого параметра.

#### 5.1.4. Указание фанфиков

Фанфики необходимо указать в файле `fanfics.csv` в папке `setting`.

Первая строчка - это названия столбцов. Каждая последующая - отдельный фанфик. Необходимо через ; без каких-либо пробелов в каждой строчке указать:

- название фанфика (можно любое, используется для логов и именования файлов);
- URL-адрес фанфика;
- номер последней переведенной главы (для новых фанфиков ставить 0).

#### 5.1.5. Первичный запуск

Нужно открыть инструмент `Shell`, затем выполнить команду: `python ./src/console.py`.
Когда приложению понадобится в первый раз отправить файл в Telegram (если отправка включена), будет запрос на код от Telegram (придет в сам мессенджер), а затем на пароль Telegram (если установили). Их нужно ввести.

### 5.2. Использование

Использование приложения состоит из [обновления отслеживаемых фанфиков](#514-указание-фанфиков) (когда нужно) и запуска приложения. Для этого надо войти в Replit, затем войти в созданное приложение и нажатие кнопки запуска (зеленый треугольник).

---

## 6. Лицензия

Этот проект под лицензией MIT. Посмотреть [лицензию](https://github.com/rrfedorovich/fanfic_monitor_and_translator/blob/master/LICENSE).
